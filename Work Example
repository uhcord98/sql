SELECT
CASE ACD_AREA_NM
WHEN 'Enterprise Queue' THEN 'Internal'
ELSE ACD_AREA_NM
END AS LOCATION,
SUM(ANSWERED_CNT) AS CALLS_ANSWERED,
SUM(CALL_OFFERED_CNT) AS CALLS_OFFERED,
SUM(CAST(HANDLE_TM_SECONDS AS DECIMAL(38))) AS HANDLE_TIME,
SUM(CAST(HANDLE_TM_SECONDS AS DECIMAL(38)))/SUM(ANSWERED_CNT) AS AHT
FROM ICM_SUMMARY_FACT_V
WHERE   CALL_ANSWER_DT BETWEEN 1220401 AND 1220430
AND ACD_AREA_NM = ANY('SPC', 'Enterprise Queue')
GROUP BY ACD_AREA_NM;
